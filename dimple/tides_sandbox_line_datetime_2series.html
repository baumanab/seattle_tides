<!DOCTYPE html>
<meta charset="utf-8">
<html>
<p>
  <label for="nValue" 
         style="display: inline-block; width: 240px; text-align: right">
         date = <span id="nValue-value"></span>
  </label>
  <input type="date" min="0" max="360" step="5" value="0" id="nValue">
</p>
<div id="chartContainer">
  <script src="/lib/d3.v3.4.8.js"></script>
  <script src="/dist/dimple.v2.1.6.js"></script>
  <script type="text/javascript" src='js/lodash.js'></script>
  <script type="text/javascript" src='js/analysis.js'></script>
  
  <style>
      circle.dimple-series-1 {
        fill: orange !important;
		r: 10px;
      } 
	  
    </style>

  <script type="text/javascript">
    var svg = dimple.newSvg("#chartContainer", 590, 400);
    d3.tsv("data/tide_days.tsv", function (data) {
	
	var date = "2016-06-06"
	
	//var date = document.getElementById("nValue-value");

      // Filter for a single Date
      data_day = dimple.filterData(data, "Date", date);
	  data_startstop = dimple.filterData(data_day,"start_stop",["start","stop"]);
	  //data_bounds = dimple.filterData(data,"Date", 
	  //data_waitwalk = dimple.filterData(data_day,"start_stop",["wait","walk"]);
	  
	  
	  
 

      // Create and Position a Chart
      var myChart = new dimple.chart(svg);
      myChart.setBounds(60, 30, 500, 300);
      var x = myChart.addTimeAxis("x", "DateTime","%Y-%m-%d %H:%M:%S","%H:%M");
      myChart.addMeasureAxis("y", "Level");
	  
	  // Draw a label for each hour
	  x.timePeriod = d3.time.hours;
      x.timeInterval = 1;
	  
      

      // Add a thick line without markers
      var lines = myChart.addSeries(null, dimple.plot.line); 
      lines.lineWeight = 5;
      lines.lineMarkers = false;
	  
	  
	  
	  
	  // Link the date selected data
	  lines.data = data_day;
	  
	  // Add bubbles for start and stop values
	  var bubble_startstop = myChart.addSeries(null,dimple.plot.bubble);
	  
	  // Link the start_stop selected data
	  bubble_startstop.data = data_startstop;
	  
	  // Add bubbles for wait and walk values
	  //var bubble_waitwalk = myChart.addSeries(null,dimple.plot.bubble);
	  
	  // Link the wait/walk selected data
	  //bubble_waitwalk.data = data_waitwalk
	  

	  d3.select('body').append('h2').text('Carkeek to Golden Gardens Hike Time Window for ' + date);

      // Draw the chart
      myChart.draw();
	  
	  var format = d3.time.format("%H:%M");
      //format.parse("2011-01-01"); // returns a Date
      //format(new Date(2011, 0, 1)); // returns a string
	  
	  
	  svg.append("line")
    .attr("x1", x._scale(format.parse("15:00")))
    .attr("x2", x._scale(format.parse("15:00")))
    .attr("y1", myChart._yPixels())
    .attr("y2", myChart._yPixels() + myChart._heightPixels())
    .style("stroke", "red")
    .style("stroke-dasharray", "3");

    });
  </script>
</div>
</html>
